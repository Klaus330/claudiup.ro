var Boxlayout=function(){var o=$("#bl-main"),e=o.children("section:not(.topleft)"),r=$("#bl-work-section"),n=$("#bl-work-items > div"),s=$("#bl-panel-work-items"),a=s.children("div"),t=a.length,i=s.find("nav > span.bl-next-work"),d=s.find("nav > span.bl-previous-work"),l=!1,u=s.find("nav > .bl-icon-close"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],v=Modernizr.csstransitions;return{init:function(){e.each(function(){var n=$(this);n.on("click",function(){n.data("open")||(n.data("open",!0).addClass("bl-expand bl-expand-top"),o.addClass("bl-expand-item"))}).find(".bl-icon-close").on("click",function(){return n.data("open",!1).removeClass("bl-expand").on(c,function(e){if(!$(e.target).is("section"))return!1;$(this).off(c).removeClass("bl-expand-top")}),v||n.removeClass("bl-expand-top"),o.removeClass("bl-expand-item"),!1}),$(document).keyup(function(e){if(!$("#bl-work-section").hasClass("bl-scale-down")&&27==e.keyCode)return n.data("open",!1).removeClass("bl-expand").on(c,function(e){if(!$(e.target).is("section"))return!1;$(this).off(c).removeClass("bl-expand-top")}),v||n.removeClass("bl-expand-top"),o.removeClass("bl-expand-item"),!1})}),n.on("click",function(e){r.addClass("bl-scale-down"),s.addClass("bl-panel-items-show");var n=s.find("[data-panel='"+$(this).data("panel")+"']");return currentWorkPanel=n.index(),n.addClass("bl-show-work"),!1}),i.on("click",function(e){if(l)return!1;l=!0;var n=a.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<t-1?currentWorkPanel+1:0;var o=a.eq(currentWorkPanel);return n.removeClass("bl-show-work").addClass("bl-hide-current-work").on(c,function(e){if(!$(e.target).is("div"))return!1;$(this).off(c).removeClass("bl-hide-current-work"),l=!1}),v||(n.removeClass("bl-hide-current-work"),l=!1),o.addClass("bl-show-work"),"undefined"!=typeof video&&!0!==video.paused&&!0!==video.ended&&video.pause(),void 0!==$(".youtube-video")[0]&&$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!1}),$(document).keyup(function(e){if($("#bl-work-section").hasClass("bl-scale-down")){if(39==e.keyCode){if(l)return!1;l=!0;var n=a.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<t-1?currentWorkPanel+1:0;var o=a.eq(currentWorkPanel);return n.removeClass("bl-show-work").addClass("bl-hide-current-work").on(c,function(e){if(!$(e.target).is("div"))return!1;$(this).off(c).removeClass("bl-hide-current-work"),l=!1}),v||(n.removeClass("bl-hide-current-work"),l=!1),o.addClass("bl-show-work"),"undefined"!=typeof video&&!0!==video.paused&&!0!==video.ended&&video.pause(),void 0!==$(".youtube-video")[0]&&$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!1}if(37==e.keyCode){if(l)return!1;l=!0;var n=a.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<t-1?currentWorkPanel-1:0;var o=a.eq(currentWorkPanel);return n.removeClass("bl-show-work").addClass("bl-hide-current-work").on(c,function(e){if(!$(e.target).is("div"))return!1;$(this).off(c).removeClass("bl-hide-current-work"),l=!1}),v||(n.removeClass("bl-hide-current-work"),l=!1),o.addClass("bl-show-work"),!0!==video.paused&&!0!==video.ended&&video.pause(),$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!1}if(27==e.keyCode&&$(".bl-expand").hasClass("bl-expand-top"))return r.removeClass("bl-scale-down"),s.removeClass("bl-panel-items-show"),a.eq(currentWorkPanel).removeClass("bl-show-work"),!0!==video.paused&&!0!==video.ended&&video.pause(),$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!1}}),d.on("click",function(e){if(l)return!1;l=!0;var n=a.eq(currentWorkPanel);currentWorkPanel=currentWorkPanel<t-1?currentWorkPanel-1:0;var o=a.eq(currentWorkPanel);return n.removeClass("bl-show-work").addClass("bl-hide-current-work").on(c,function(e){if(!$(e.target).is("div"))return!1;$(this).off(c).removeClass("bl-hide-current-work"),l=!1}),v||(n.removeClass("bl-hide-current-work"),l=!1),o.addClass("bl-show-work"),$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!0!==video.paused&&!0!==video.ended&&video.pause(),!1}),u.on("click",function(e){return r.removeClass("bl-scale-down"),s.removeClass("bl-panel-items-show"),a.eq(currentWorkPanel).removeClass("bl-show-work"),!0!==video.paused&&!0!==video.ended&&video.pause(),$(".youtube-video")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),!1})}}}();